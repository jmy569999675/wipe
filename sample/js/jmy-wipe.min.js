/*! jmy-wipe - v1.0.0 - 2018-11-13 */
var context=(cas=document.querySelector("#cas")).getContext("2d"),_w=cas.width,_h=cas.height,radius=20,lock=!1;function drawMask(e){e.beginPath(),e.fillStyle="#666",e.fill(),e.fillRect(0,0,_w,_h),e.stroke(),e.restore()}function drawPoint(e,t,n){e.save(),e.beginPath(),e.arc(n,t,radius,0,2*Math.PI),e.globalCompositeOperation="destination-out",e.fillStyle="red",e.fill(),e.save(),e.stroke(),e.restore()}function clearRect(e){e.clearRect(0,0,_w,_h)}function drawLine(e,t,n,o,a){e.save(),e.lineCap="round",e.lineWidth=2*radius,e.beginPath(),e.moveTo(t,n),e.lineTo(o,a),e.stroke(),e.restore()}function getTransparencyPercent(e){for(var t=e.getImageData(0,0,_w,_h),n=0,o=0;o<t.data.length;o+=4)0===t.data[o+3]&&n++;var a=n/(_w*_h)*100;return console.log("透明个数"+n),console.log("占总面积"+Math.ceil(a)+"%"),Math.round(Math.ceil(a))}cas.addEventListener("mousedown",function(e){var t=e||window.event;posY=t.clientY,posX=t.clientX,drawPoint(context,posY,posX),lock=!0},!1),cas.addEventListener("mouseup",function(e){lock=!1,50<=getTransparencyPercent(context)&&(console.log("大于50%面积"),clearRect(context))}),cas.addEventListener("mousemove",function(e){if(!0!==lock)return!1;var t=e||window.event,n=t.clientY,o=t.clientX;drawLine(context,posX,posY,o,n),posX=o,posY=n},!1),window.onload=function(){drawMask(context),drawLine(context)};context=(cas=document.querySelector("#cas")).getContext("2d"),_w=cas.width,_h=cas.height,radius=20,lock=!1;var cas,posY,posX,device=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase()),down=device?"touchstart":"mousedown",move=device?"touchmove":"mousemove",end=device?"touchend":"mouseup";function drawMask(e){e.beginPath(),e.fillStyle="#666",e.fill(),e.fillRect(0,0,_w,_h),e.stroke(),e.restore()}function drawAll(e,t,n,o,a){if(e.save(),e.beginPath(),3===arguments.length)e.arc(t,n,radius,0,2*Math.PI),e.globalCompositeOperation="destination-out",e.fill(),e.save();else{if(5!==arguments.length)return!1;e.lineCap="round",e.lineWidth=2*radius,e.moveTo(t,n),e.lineTo(o,a)}e.stroke(),e.restore()}function clearRect(e){e.clearRect(0,0,_w,_h)}function getTransparencyPercent(e){for(var t=e.getImageData(0,0,_w,_h),n=0,o=0;o<t.data.length;o+=4){0===t.data[o+3]&&n++}var a=n/(_w*_h)*100;return Math.round(Math.ceil(a))}cas.addEventListener(down,function(e){var t=e||window.event;posY=device?t.touches[0].clientY:t.clientY,posX=device?t.touches[0].clientX:t.clientX,drawAll(context,posX,posY),lock=!0},!1),cas.addEventListener(move,function(e){if(!0!==lock)return!1;var t=e||window.event;t.preventDefault();var n=device?t.touches[0].clientX:t.clientX,o=device?t.touches[0].clientY:t.clientY;drawAll(context,posX,posY,n,o),posX=n,posY=o},!1),cas.addEventListener(end,function(e){lock=!1,50<=getTransparencyPercent(context)&&(console.log("大于50%面积"),clearRect(context))},!1),window.onload=function(){drawMask(context)};